if (window.jsredtRestorable = function () { var t = this; this.restorableNodesTag = document.querySelectorAll("jsredt-restorable"), this.restorableNodesAttr = document.querySelectorAll('[data-jsredt-restorable="true"]'), this.restorableHtml = [], this.restorableAttr = [], this.restorableUndoHtml = [], this.restorableUndoAttr = [], this.restorableHtmlCount = 0, this.restorableAttrCount = 0, this.restorableNodesTag.forEach((function (e) { t.restorableHtml[t.restorableHtmlCount++] = e.innerHTML })), this.restorableNodesAttr.forEach((function (e) { t.restorableAttr[t.restorableAttrCount++] = e.cloneNode().attributes })) }, jsredtRestorable.prototype.restore = function () { var t = this, e = 0; e = 0, this.restorableNodesTag.forEach((function (i) { t.restorableUndoHtml[e++] = i.innerHTML })), e = 0, this.restorableNodesAttr.forEach((function (i) { t.restorableUndoAttr[e++] = i.cloneNode().attributes })); for (let t = 0; t < this.restorableNodesTag.length; t++)this.restorableNodesTag[t].innerHTML = this.restorableHtml[t]; for (let e = 0; e < this.restorableNodesAttr.length; e++)Array.prototype.slice.call(this.restorableNodesAttr[e].attributes).forEach((function (i) { t.restorableNodesAttr[e].removeAttribute(i.name) })); for (let e = 0; e < this.restorableNodesAttr.length; e++)Array.prototype.slice.call(this.restorableAttr[e]).forEach((function (i) { t.restorableNodesAttr[e].setAttribute(i.name, i.value) })) }, jsredtRestorable.prototype.undoRestore = function () { var t = this; for (let t = 0; t < this.restorableNodesTag.length; t++)this.restorableNodesTag[t].innerHTML = this.restorableUndoHtml[t]; for (let e = 0; e < this.restorableNodesAttr.length; e++)Array.prototype.slice.call(this.restorableUndoAttr[e]).forEach((function (i) { t.restorableNodesAttr[e].setAttribute(i.name, i.value) })) }, !("jsredtRestorableObj" in window)) var jsredtRestorableObj = new jsredtRestorable; window.jsrHtmlEditor = function (t = {}) { var e = this; this.restorable = window.jsredtRestorableObj || new jsredtRestorable; const i = { editable: "body", linearHistory: !0, groupingHistory: 200, toolbarCols: null, saveTimeout: 500, maxImageUpload: 12e5, toolbar: ["edit", "undo", "redo", "up", "down", "cut", "copy", "paste", "code", "link", "image", "head", "save"], buttons: { edit: { name: "edit", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAABP0lEQVRo3u3YMU4CQRTG8T+7nkM3HkUTK26BHa2Vt9BGGlAEgl5Dz2E2XoFGGqLNTljJDDNLwXtD3pdMQTIkv+/tsNkFLBaLxQIV8AmsgAeglAZ1yTnwBfy21jtwJg07FJ9NiX34LEoMI3i3Fij+TdwnlniUhrpUwNUBJVbScIevgR/gpmOJDy14B+pSogYuJPGhu80a6O/svdvZ8w1casSnlBDHV/w/NqHlO07D5vtiCU1+AgyADfErIZYK/+THQNHsucV/Ja6l8fsm7/A94MmzR/zMnyT++ZTwo1zxRfM5G/yS7eNvAbwY3vBpePfqlx3+rYUvc8dPDW/4OL79X41aPPgfiedsb5UlMPPsqRF+GXGJTf4VpZMPFWhPfo7iyYcKOLz6yYcKhJZKfGoBtfiUAqrxsQLq8RaLxXKc/AH+RGvPIDl6DwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wOS0xNlQxNDo1ODoyMyswMDowMGRD6r4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDktMTZUMTQ6NTg6MjMrMDA6MDAVHlICAAAAAElFTkSuQmCC", icon2: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAACI0lEQVRo3u3YsWoUURTG8Z9ICIiNsDEiioioKGEbK0uxUWwkjU9kbRUbn8BitQkE0byBTUSx0FgkisaAaCGITSx2Bzezd3buzM7OzJL9YNhqzvy/c+45995lrrnmmmsuOljHL6xhoWmgIlrCFg6GnnUsNg1WFn5mTCzhTQZ8aRMdbKJbg4E7+Jtj4AA9kT3R8b+c+zWZWI00sRYT7FXqpWmY6AZixpj4GRN8BXtTNNEdxAvFzDPxMvYjV/El9fIP3KgIflzMe/gTgN/GcpGPXcHnCk2k4YuY2B/wFNZl7FZgIgs+xsRv3CyZNHAJO8r3RB78uJiruDsJfKIL+muwaCWy4Hu4b3StV9FnY018ishaDHyyIT0QV4nKdB4fIz/4Igf+OJ7WbQDO4J380p90eFMchj+GJwH479OGT7SMtxEmFvE8AP+4SfhEoUqEyr/g8CHskQaWTZZOGz0Kj5skD7Ug82ndFpfRE0YvLY1lPtG4TSpUiVN4rSWZj9lhQxmu87JUGH5DP7OtWiax8MmovIav4hu7VfAGvxtaNCqLwj+T3RONVaIK+MZMTAL/Hrc03BMx8L0M+OQOG0pCbT1RJvMfcDYVp7HplIbLy/w2zmXEaqQSacAEPpT5HVzMiVd7JfKmSvLs6v8BEKNaTcTAfxtAFVFtJvLg93C9ZOxaTOSdNlcmjN/qs9ORMhEasZtNQxXVcCW29C8/M6eufuZnEv7o6h+WFd8aD3ft0gAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wOS0xNlQxNDo1ODozMSswMDowMD92+wkAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDktMTZUMTQ6NTg6MzErMDA6MDBOK0O1AAAAAElFTkSuQmCC", title: "Edit", disabled: function () { return e.disabledEdit() }, action: function () { e.editToggle() } }, code: { name: "code", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAACIElEQVRo3u2ZsUscQRjFf8ZCMFVSmFIskiqkUxEkXbAJFmJO0MQmraSxDYLYJVVII5axCakEm5C/IBwh2ClBxPaKWNhEjMlZXA7mHrPZmZ3ZGYR9cMXevO99783s7c7tQoMGDRrkxHCiPgvAHjADjAO/gE7u8D54A3SNz9tYwrcSBZiS43aivlEwDJwzuALjuU354JGYj3ruh55Cyw6cSTluV9CoBS3gtwNvh8EVeC3jV8CLXOa7DtwDCfBExrupQ5jmywKMCvcvcMcSIFkINV8W4LFwjywcc7zWEMv/GpgNy34D68LftXB0Qq6o4Ydtm3mXRp+kZs3CWQQuqXElqpoHOJW6yQJebSFCzI9J3QUw8h9+9BAh5gHmpfarQ020EKHmAbak/p1jXXCIGOYBvojGc4/ayiFimR8CzkTnvqeGUwjXzdyQZ/MHDN5xz4BjT42ivqXbl6JVWPFovCr1nz2NLxZ4cD4NnwUKvJfaTQ/zob2jCLWl7mlq8yGCI/RuWmbNvRzmqwpPC/fEoUfLs0e0ELbr8ivhfcxtvo+lgkaKXeGsl+jatuhLsc33Ybu8KX7I+GyJZsjlOkoIE3fp/W00Z/O2Y4Ak5m0hTMwxOKPfHbSSmzdDXMp3GxJg20Eni/k+WnK8LwFeVtDIio4EeJjbkA8mxPw5Cd4/xHy8ro/QvwF/bnKAJO8AYi5xh95N7Ce9Dd0H4DBFiAYNGjTIh2vrWlwSpGLTnQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wOS0xNlQxNDo1OTo1MiswMDowMCczgy0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDktMTZUMTQ6NTk6NTIrMDA6MDBWbjuRAAAAAElFTkSuQmCC", title: "Code", disabled: function () { return e.disabledCode() }, action: function () { e.editCode() } }, undo: { name: "undo", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAABhklEQVRo3u3WMWsUURDA8Z9i5CQaG5toIURMIRLUJo3Gyi5fxVYbwWATIYVo48ewsLJUsFFMYZVCiyTNhQhBwXDEnGfxVjiWvTWn7xED84dpdpeZ+e/Mg0cQBEEQBEEQ/E88PuwG/pXBUZI4MeL5ffSwNEauCdzELdzAZUzjNH7gC7axibd4g1Xs55YaDMVBBK7iedXgYMzYwZNKtohAm8QVvMTPv2i8Hv0q12wJgfqZmJBWbC9D4/XYq2p1cgv8nsRFaW9zN16PDzh/kGaPjRAYxXdMtrzfxWu8wntsoVvlPCcd6nncxh2cacm1iUV8zDWBtuji3h8aqjOFu/jUkvcr5koK9LGMU+MWGaIjrWdvRI11aXLZBb5Jq5CLa9LaNNV6h5MlJrCUUQAuSDvfVOtBCYES145pbDTU2cWlEgIlJnFd85l4UUqgxCQeNdToY6aUQO5JdPC5ocbK8EfHM/+1hxklenhae9aVrhut5LgK5JI4izU8w4L8PzwIgiAIgiAIgiPML+zxM5YSM3skAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIyLTA5LTE2VDE1OjAxOjUyKzAwOjAwmCW2HgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMi0wOS0xNlQxNTowMTo1MiswMDowMOl4DqIAAAAASUVORK5CYII=", title: "Undo", disabled: function () { return e.disabledUno() }, action: function () { e.undo() } }, redo: { name: "redo", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAABiklEQVRo3u3WT0tUURjH8U+hhoSuijQqd4oECS1aBJK73ktvoCCs2am7auHLCIJatSraRFjbsDYFUVAgRqFWji7uLPQ4c+femWO6eL5wFvfP8/D9nXMv5xAEQRAEQRAEQTUaRy3Qr/xOenMgQ+MBXMUNXMdFnMUZDOIXvuID3uIlXuFfTfn7uWdkEg+x1pqZOuM7lnG5ovze2r6ZwjM0exBPRxNPMF1Rvq8Ag7iNzQzi6fiLRZzqIt9zgPNYOQTxdKxgokT+QIATFeRn8BQXSt75ied4gdf4hh+t/mM4h2u4qfjZh0t6/cbpkudVnPfJr5fMxipuYaRGz1HcaYXsZZUqM47PHZpsYB5DdRomDGMJ24cRYAhvOjT4hCt9iKfMKT7BrAHudih+11qZnDRqyFcKMKHYPdPCL8p/5P8hXynAY+2/+ZljIN81wCXFGSUtundM5LsGWGhT8NH+HfIo5Q8EOJlc/1GcHPfyAFsZ5bOfKtuFmsUjvFdsPLnkcxw3giAIgiAIgiAIwC7w7i5ZynjYFQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wOS0xNlQxNTowMjowNCswMDowMFgiNkMAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDktMTZUMTU6MDI6MDQrMDA6MDApf47/AAAAAElFTkSuQmCC", title: "Redo", disabled: function () { return e.disabledRedo() }, action: function () { e.redo() } }, up: { name: "up", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAAAsUlEQVRo3u3VTQqCUBhG4dMP0aBZbaLVNWzaRlqJm2gpzmoSNXGQYJJe7bsXzgOCA9H3CCJIkqRei+gBKS7AFVhGDxk7/tUcxUV8ji8uomt8MRF947OP+GV8thFDxmcXMWZ8NhEp4yeJWCWMPwFn4PHl2NL+C9fAveO6I7AHqr+88gFq2m/6MMdDsviIDCiZAdEMiGZANAOiGRDNgGjFB6xnvPcN2DXnG+AZHStJkqb2BvfBZVUwT6fHAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIyLTA5LTI3VDExOjAxOjU1KzAwOjAwYMkoEwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMi0wOS0yN1QxMTowMTo1NSswMDowMBGUkK8AAAAASUVORK5CYII=", title: "Select up", disabled: function () { return e.disabledUp() }, action: function () { e.up() } }, down: { name: "down", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAAArUlEQVRo3u2XvQrCMBgAT9FJEAqu4vO4+BgOvrSv4NjJOgm10Gp/vwTv4JuSkLtsAREREelkBxTAKlqkLw+gqs1hjkvW0ZUGRAsYEC1gQLSAAdECBkQLGBAtYEC0wN8HbEacPQLbjvXm45yAfcveCrgvHX8GSj5/XUPmCdyWlp8qIlR+bEQS8kMjkpLvG5Gk/K8RSct/i8hCvi0iK/lmRJbyby7ANVpCRERE5uIFO9pmz/tN+9wAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDktMjdUMTE6MDE6MzcrMDA6MDAxOTC9AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA5LTI3VDExOjAxOjM3KzAwOjAwQGSIAQAAAABJRU5ErkJggg==", title: "Selenct down", disabled: function () { return e.disabledDown() }, action: function () { e.down() } }, copy: { name: "copy", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAAA7klEQVRo3u2ZSw6CMBRFj4apcQMyZu0aEscO3JGagAvAATqQQOTTvlfiPQmTQuk9bdKXtCDSJAdKoAaayE+U8HeD4NEESsPwiwU2PW01sIsxMxMyLOrcjPgmGbbeASTgHcBLwKJO1MAZKKaG+7XNWdeJx3vMYALWdaIBTkNh52yj1nXiM+Y+lIBVnRg1zt/uQskgAW8k4I0EvJGANxLwRgLeSMAbCXizeoGspy3ps9Auq18BCXgjAW8k4E02o8+T78PdKFelHaqhF3NW4GoQuMsl5M8K2ksHq7uBG3AIPSM57aVDFTF4BRxjhBcheQHmPezLx9HoXgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wOS0yN1QwNDozOTozNCswMDowMArEXrAAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDktMjdUMDQ6Mzk6MzQrMDA6MDB7meYMAAAAAElFTkSuQmCC", title: "Copy", disabled: function () { return e.disabledCopy() }, action: function () { e.copy() } }, cut: { name: "cut", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAAB9klEQVRo3u2YTU7CQBiGHzHqCgzXELmAceERSIhncUndGRFTAtHD+BNdeAAFI3HJDQSXGFxMScgU2pnOtDOLvskkJP2m87ztVzp9oVSpUmlqAn1gDPxGYwyEwLFruCQdAHfAH7DcMhbAENh3DbsJ/jkBXB5Plk0ECWsp6V4DfjUGBcArGWgSb5sp0Aaq0WgBE+Lt1MgZPlA5SShN+gLqG+rqkbH12lvX8ACf0sRWQu25VDtyDQ8wkyZXE2prUu3MNbyugUOp9sc1POi1UFuq/XAND/GHeML2h/hbqr12DQ9ie7CQTjhFPLC1aLQ3wC+Bnmv4lYYpi2QFKAQexLbg0bKJwuDXTQyIt1NWE4FGrVU1EG/YETBH/FW+A11Ez5uayBVeRRcpJq4S6jumi+9aMPAG7ABnW46fRsdfpPpX4NLWVbQh3TvhpQIJ+gRxB3Lr90rOhiqIdlmpk4cJWwpQ/4v1rp104L0zkQW+UBNyLjRDvNRuUHuRpRkM8gJXyYVUwQo3oZsLebeZy5ILebOdzpoLefNBE0on1MmFuopr5GrCJBfy4qPeJBfyIlYxyYW8CLZMciEvosVQmqyTC3kR7mbNhRbAkYEBqyay5EJ9Q3hVE0rSzYUegD1LBtJMKEslF1ogrrxNeOuSc6F59LuHec+XKlXKUP835G8IanS10wAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wOS0yN1QwNDo0MDowNCswMDowMFFlZxoAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDktMjdUMDQ6NDA6MDQrMDA6MDAgON+mAAAAAElFTkSuQmCC", title: "Cut", disabled: function () { return e.disabledCut() }, action: function () { e.cut() } }, paste: { name: "paste", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAABG0lEQVRo3u2ZzWrCUBBGj9WtUNc1a99KfT1F6KYoXbgVq6+iQiK4TRcmoGKS3h/7WToHZhHIzP0OCVlkID4dYAxsgVNRG2AEtB9wXlR6wBeQV9QaeFWHrKLdEL6sFfCiDnuP8Q/ClzX8rVAJMAMyh3BlfQBvQB+Ye/RnwDswCAm/9zi4rP7NLN85h6LfmVnAoTEFcmDqI+Dz2lzWvJBIgEXgrLQqZKtGIG+4NycuTfPvZn3Kz5kLJqDGBNR0AnpbAb3R+PNPwATUmIAaE1BjAmpMQI0JqDEBNSagxgTUmIAaE1BjAmrq/swdge7Fdex9gAuVC466J7AUBr7l06dpwHnBFrIailE7rvdtTiScF2ypIHgKTELCG8Z/4BuHD+VLGLARSgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wOS0yN1QwNDozOTo1MCswMDowMDjkcyQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDktMjdUMDQ6Mzk6NTArMDA6MDBJucuYAAAAAElFTkSuQmCC", title: "Paste", disabled: function () { return e.disabledPaste() }, action: function () { e.paste() } }, link: { name: "link", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAADHElEQVRo3u2ZzUsUYRzHP7uBSh0qLTtUKKuBQdGpOkSkFBQEnZLqYJEQBL0IEkT0B1QQhYc6mG1u18B7eRGtSxHUUahs7WZrmEX4Eurh2YHxO2+77szOCvuFYXlmvvP7fZ6Z53n2eZ6Bqqqqal0rEVPeOuAo0AQ0ADngO/AWmI/7ofgpBWSAv8Cyy/EHSAPNcYO6qRdY8ADXYx64HjewpSTwrEBwPfqCgm8oA3wa6Ha59g0YAoaBL0A9sFk8hzH940PEnJ7wgzifag7oxDmAJIEuYEb8c5jOXhHwk0BrwL37XSrxvFLgUwXG6JJ7Z4GacsFnSoS34mQlRsd6gbf0QuK4DQQkQ6zAAHBRzv0A2jEjTrGaknJDlBW4DVwOER5gu5R/hcTq0D7gP4U1mx3AAYIfXAKYoEx9YEgSTQEtLr5TwL+85zX+o8oFnKNQbRTw9cCiJDvt4R0WX7+HrxWYFm86CniA85Loo4/3Kc4R6ph4GjDTap3YNUdVgbuS7J6PdwswLv5R8WzKA9s9N8OCTQJtcu6xJOsJiHEIWLL5l4Cd4hkluJmtgioUPg2ck/O/pbw1IM57YMxWTgAnxPM5/5sBroZRAQv+EqbT2pWVcnsB8UakrDPN6Tx8N+YNlSz7YkST78LZJA4GxOthdbN7JNfbCHGG0CvJ5oCN4hkTzzimw3rpgfjvhAWrSuFcw04C28TXgXN4fOIT95N4z0ZVAZ1Z5vBejOia942H74z4FvB/W2tWHc6tj04ffw1merCMmS6cdPG0AD8l5qso4MEMbfZEXwneBEtiJmqNLtdSmOZnj7kI7I2qAlck2UAJsdzgl4FbYYB6DVf6h5QrAX4E2C3n08DDKCugi4fGoEBFwL/EvOFIdZzVrztLcX8uXs0mU2ScNasWs9FqT95VIvxgueAtpQVgBrPp5Kc9lQIPZhGhc/MZzM6DwiQwy0BdScUGb+mGC5DVJwaB+5j9mwkPX6zwlvo84IKO/kqAt3QNMxMt9ONEaMvAMNWE2SWe9QCP5fPQWj7y1QBH8qCNmH2gLPCOCv9AV1VVVVWgVgAPDHRgefYM4AAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wOS0xNlQxNDo1OTozMiswMDowMOFciqoAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDktMTZUMTQ6NTk6MzIrMDA6MDCQATIWAAAAAElFTkSuQmCC", title: "Link", disabled: function () { return e.disabledLink() }, action: function () { e.editLink() } }, image: { name: "image", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAABzUlEQVRo3u2ZyUrDUBSGvzosxLEqqAj6AKJvIK58AKdncOXeCUdc+BKiILoQhYLgwpUg4hOIIu4UdyotKDi0LpJLQ8hNk7S9p4X7wYHCPWn+L0N7cwMWWRqr/P0bwARwJS2aNHzBrTXpMHHZdIN/u1UAVqRDJQk/BUx7JFalw8UNr5ihDs6ELrxiFvhxe5alw/rZKhE+SGJJOnTc8Io5j8RiuTtPlRgfBNaBcaBPs32X+/kXyEXcbwfF/6B3TU8OyODc+NkkcsPAM8Xfcql69BykWJzUQHhVe7qQYZdQFmhPYl4FPoB03I38R8EkvVH332A4WMWxAtJYAWmsgDRWQBorII0VkKbSAmmgW1pKkWQ6fQZcUv6SZeTpdCUFFjy9OyV6Sz2LGxcYA748vXmcJZQg+oFroKdWBNqA+4D+HDDi620Bbt3xc/T3oFGBQ/QP4w9Ap9uXAo5847oVOmMC8yHhVWXc8NsBY3/ApJTAKPAZQUBdLnnN2CswYFqgFbiLGD5K3QDNJgX2Kxhe1a5JgWpj14XqhroXaAoZy+Ks4ytM3wdedO8QQs/AhWBgP6dJNhoCXpB/N/BEcTqSSOIYZ33edPA34ABn9mqpWf4B0/l4sgdYXjsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDktMTZUMTU6MDE6MTUrMDA6MDDZyIZqAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA5LTE2VDE1OjAxOjE1KzAwOjAwqJU+1gAAAABJRU5ErkJggg==", title: "Image", disabled: function () { return e.disabledImage() }, action: function () { e.editImage() } }, head: { name: "head", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAADI0lEQVRo3u2ZT09TQRTFf4KtCRBNwJIodK0LdwgWd+BnMBDdgaisCYluXAqu1QBxSeKfGFeKSz6AAZMaNzRxYQWbKC6gKGWhdTGvyePOtH3TzrQYe5JZzOvMmXPfu3PvnSm00ML/jWOOeNqBIWAEGADOA2eAruD3PeArsAGsA6vAO+BPs19AEpgHNoGiZfsCzAH9zRCeAJaAgxqEy3YALACnGyX+GvDDgXDZtoFxn8JjwJMKAnaAp8ANYDD4SrGgJYJnU8AzYLcCz2Iwxyk6gLdlFtwAJoIxNnyTQKYM54olX9U3bxL/C5gBjtfJPQvsG/jf4OhLmNwmA1xw9YaAFCrMynUW6iW+biB9j/Jp1+gH0ob1xmolTKBHm4wn8WEjcmLN70BPLWRL6D7v0m3KIQUUxNqPbUmS6ElqpgHiS7gn1i5gmbHn0UNlPdHGFl3orjQXdXI7em0z0UDxJUwLDVmgLcrEYTFxB4dJxQKdQF5oGZKDTBaNiP4KagM3Gj+DtcMYjWLAgOivNkF8ubWlNqMB50Q/Lfpx4AEqc26hNnzc0xi5ttRmhExesk6XEaoYPPMxphc9qVWFjP/yrZhqlpynMSfQ88EhRApLAkXDs9+exlSFyYA90T8p+suGOcuexpwS/XwUoz5SOfbGUb66ReUN6mJMSmj5EMWAV2LSVJRJnnBLaHkpB5hcaE30R2kerlTRZoT8bLscnVJiMMrENtSlU3jiZBMMmBIaPmMRNefE5AwerjoqIA58Ehru2xD0oye02QYacAc9gfXZkiwIkn3U/vCNy+hHyoe1EHWjag+Z6pMexZ9FP0xtU8e96Th6vZLGz41yEpWo5HpX6yVeNJDmcOtOw+hn4CLwyAV5DHUykuQF1O1BZx3cceAuus8Xgdc4vEjoKGNE6WtMWxrSCdxED5Vh8c6TZww9MoVbHniOql8uoQ4j8aD1Bs9uAy/QM6x0G69XOGPo0clF+4aDDRsVPajrPpPv2rYCKs53N0p8GH2osiNbg/AsqjywzrBhuPqbtQ24iCq9B1C3B30c/pt1E1VTraGuS9Y5An+zttDCv46/K53XmFVUFdIAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDktMjRUMDc6MTM6NTQrMDA6MDAX56YDAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA5LTI0VDA3OjEzOjU0KzAwOjAwZroevwAAAABJRU5ErkJggg==", title: "Edit head", disabled: function () { return e.disabledHead() }, action: function () { e.editHead() } }, save: { name: "save", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAABXElEQVRo3u2ZMU7DQBAAJwjhVHyA0KGInoJPAfkCJR+hAsQDEC1JqkDDL0BKTE0oHCQU2T77srtnix3pKq9vd3zrs04Gx3GcLnMKPAIrYK08rqWLPwY+DQpXk7g3Ll5cwqJtVCW2J9XijPJWvemLgJpElYBUm6hLWAuIS6QQqJPojQDAedP4QUCgLFbqhR4Erq+bxO8JFZMMF0jNfsQ9od41pfcr4AKp0RAYAhNgDnxtxgy4AjJLuZhP+Qh4o/rr+7qJ0cq/0wTDQPF/JZqshLnApEHxv+OyiwLzFgLTLgrkLQRyqfypttFvqYkkBd6VYs0EbpVio2n7DmQUW2So/xfAgUJ+kQlGAYkFcKSYX2SCjGKfn1LsNjnwAlzQ7Mm3yh9zJrbif5yJ605kK+Cw5olYsqy6ULcCzwkL3uYp5qYx9j84ysYHcBJrPgYeKJbQuvAlcLdL8Y7jOPr8ALb40CVRgUo/AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIyLTA5LTE2VDE0OjU4OjU2KzAwOjAwPL7MAAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMi0wOS0xNlQxNDo1ODo1NiswMDowME3jdLwAAAAASUVORK5CYII=", icon2: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAABvklEQVRo3u2Zu0oDQRSGv0jUWKigTZAIYiH2Bn0FOx/AQiSVVV4hpYiVta3YeEGsLSwEo40+gRcQO4MXtIzF7uKyzGSzs3NmDcwPU+25/N/mZGaXBS8vL6//rEXgFPgAusKrZdv8LPDmwLgYxJFj89YhXIyNKESyqJSWUI/q9qAAiEHoAGyNiTiEawDrEEUA9IIYGACAlX7jSykAqlhbf+hSyvVuP/FDlswUJg9QtMoGOWmz61QD/wt4gKIlAVABmkAb+ArXNbAFjGSo85rXiMlRXgPu0Z++hxn6jwIN4DlD/1wAlRTzB8C4gY9p4NwFQLOH+V3ybb9GuVkB2ujvfCFnR1aAT0XOIzBh2L/qGuBbkbNu2LtO8E5gmm8EcJuIf8Jsm64DnbDGD7DsCmAzEW/yGhg3H60rVwBl4CYWv6qJm8lg/gGYcwUAMMXfblRTXG+FJuvS5k0BIJj7DWBYYT6qFYcQMZ8HQKedRL0OwaOCiHkJgBKwr6ib3LnmbZgHeE9plrbWFDXLwJkm3tqdj3SSE2BPU3cMuJQ2D7BAvg8cLwSPxCpNAneS5uMQx5iPU6NH7SpwIWney8vLS16/eT7oBHxeUFYAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDktMTdUMTY6Mjk6NTQrMDA6MDCj7IdOAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA5LTE3VDE2OjI5OjU0KzAwOjAw0rE/8gAAAABJRU5ErkJggg==", title: "Save", disabled: function () { return e.disabledSave() }, action: function () { e.save() } } }, draggerIcon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAAA+klEQVRo3u3ZUQ7CIBAE0NGDGOL9r+SHJ6k/bWJIkV3KDrvCJHx3XgwsrcDKiuukfYXMA8ALwBvAc3SZ1vLbvkIh8vKhEKXyIRC18q4R0vIuEdryrhCt5bshboa4jfGsuyGAkukAidDJ7BnHhpUm37DSmJxO36eNNaD7EZsflQxAN8TZOc8CXEaUhhQT0Iz4NWHZADXi6vXAaokQXssXEeEn8Vm8/grd9oE0wzZxDcEGdJ8FTIDJNGYBzO5DDIDpjdQaYPqynwgAzTPWS/3wTA/QTOy/+zrnonwrwlV5LcJleSnCdfkaIkT5EiJU+RwRsvyRhMB/dK9MkQ9aiYmYo9JGZAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMi0wOS0xNlQxMjoyOTo1MSswMDowMJ8FU+4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjItMDktMTZUMTI6Mjk6NTErMDA6MDDuWOtSAAAAAElFTkSuQmCC" }; this.options = this.deepMerge(i, t), this.options.groupingHistory = this.options.groupingHistory / 1e4, this.editEnable = null, this.clipboard = null, this.editable = document.querySelector(this.options.editable), this.editableInBody(), this.wrapEditable(), this.init = document.querySelector("#jsredt-init"), this.initToLastBody(), this.focused = this.editable, this.focusedPrev = this.focused, this.observer = this.setObserver(), this.historyUndo = [], this.historyRedo = [], this.historyForce = [], this.setEventEditorChanges() }, jsrHtmlEditor.prototype.deepMerge = function (t, e) { for (key of Object.keys(e)) t.hasOwnProperty(key) && "object" == typeof e[key] ? this.deepMerge(t[key], e[key]) : t[key] = e[key]; return t }, jsrHtmlEditor.prototype.isEditEnable = function (t, e) { return this.editEnable }, jsrHtmlEditor.prototype.getFocused = function (t, e) { return this.focused }, jsrHtmlEditor.prototype.getFocusedPrev = function (t, e) { return this.focusedPrev }, jsrHtmlEditor.prototype.getEditable = function (t, e) { return this.editable }, jsrHtmlEditor.prototype.getClipboard = function (t, e) { return this.clipboard }, jsrHtmlEditor.prototype.editableInBody = function () { this.editable.contains(document.body) && this.editable != document.body && (console.log('The highest node that can be edited is body, set options.editable = "body"'), this.options.editable = "body", this.editable = document.querySelector(this.options.editable)) }, jsrHtmlEditor.prototype.wrapEditable = function () { this.editable = ((t, e = document.createElement("jsredt-editable")) => ([...t.childNodes].forEach((t => e.appendChild(t))), t.appendChild(e), e))(this.editable), this.editable.id = "jsredt-editable", this.editable.setAttribute("contentEditable", "true") }, jsrHtmlEditor.prototype.initToLastBody = function () { var t = document.createDocumentFragment(); t.appendChild(this.init), document.body.appendChild(t), this.init.insertAdjacentHTML("beforeend", '<div id="jsredt-container"></div>'), this.init.insertAdjacentHTML("beforebegin", "\x3c!-- jsredt-init:begin --\x3e"), this.init.insertAdjacentHTML("afterend", "\x3c!-- jsredt-init:end --\x3e"), this.container = document.getElementById("jsredt-container"), this.container.insertAdjacentHTML("beforebegin", "\x3c!-- jsredt-container:begin --\x3e"), this.container.insertAdjacentHTML("afterend", "\x3c!-- jsredt-container:end --\x3e") }, jsrHtmlEditor.prototype.start = function () { this.editOff(), this.tollbar = this.renderTollbar(), this.dialogCode = this.renderDialogCode(), this.dialogImage = this.renderDialogImage(), this.dialogLink = this.renderDialogLink(), this.dialogHead = this.renderDialogHead(), this.movable("#jsredt-toolbar", "#jsredt-toolbar-dragger"), this.movable("#jsredt-dialog-code", "#jsredt-dialog-code .dragger"), this.movable("#jsredt-dialog-image", "#jsredt-dialog-image .dragger"), this.movable("#jsredt-dialog-link", "#jsredt-dialog-link .dragger"), this.movable("#jsredt-dialog-head", "#jsredt-dialog-head .dragger"), this.setEvents(), this.setEventsToolbar(), this.setEventsDialogCode(), this.setEventsDialogImage(), this.setEventsDialogLink(), this.setEventsDialogHead(), document.dispatchEvent(new Event("editorstart")) }, jsrHtmlEditor.prototype.editOn = function () { var t = document.querySelectorAll(".jsredt-toolbar-btn-edit img"); for (element of (this.editable.setAttribute("contentEditable", "true"), t)) element.src = this.options.buttons.edit.icon2; this.editEnable = !0, this.setFocus(this.focused), this.observe(), document.dispatchEvent(new Event("editorchanges")) }, jsrHtmlEditor.prototype.editOff = function () { this.observer.disconnect(); var t = document.querySelectorAll("*[contentEditable]"), e = document.querySelectorAll(".jsredt-toolbar-btn-edit img"); for (element of t) element.setAttribute("contentEditable", "false"); for (element of e) element.src = this.options.buttons.edit.icon; for (focused of document.querySelectorAll(".focused")) focused.classList.remove("focused"); this.editEnable = !1, document.dispatchEvent(new Event("editorchanges")) }, jsrHtmlEditor.prototype.setFocus = function (t) { if (this.editEnable && t && t.isContentEditable) { for (oldfocused of document.querySelectorAll(".focused")) oldfocused.classList.remove("focused"); this.focusedPrev = this.focused, this.focused = t, this.focused.focus(), this.focused.classList.add("focused"), document.dispatchEvent(new Event("focusedchange")) } }, jsrHtmlEditor.prototype.save = function () { var t = this, e = this.getDocumentHTML(), i = document.createElement("a"), o = document.querySelectorAll(".jsredt-toolbar-btn-save img"); for (button of (this.saving = !0, this.editOff(), o)) button.src = this.options.buttons.save.icon2, button.parentNode.disabled = !0; i.setAttribute("href", "data:text/plain;charset=utf-8," + encodeURIComponent(e)), i.setAttribute("download", "index.html"), this.container.appendChild(i), i.click(), setTimeout((function () { for (button of (t.saving = !1, o)) button.src = t.options.buttons.save.icon, button.parentNode.disabled = !1 }), this.options.saveTimeout), this.container.removeChild(i), this.editOn() }, jsrHtmlEditor.prototype.getDocumentHTML = function (t = null) { var e = ""; return window.scrollTo({ top: 0, left: 0, behavior: "instant" }), this.restorable.restore(), this.removable(), e = t ? document.querySelector(t).innerHTML : (new XMLSerializer).serializeToString(document), this.undoRemovable(), this.restorable.undoRestore(), this.jsredtRemover(e) }, jsrHtmlEditor.prototype.jsredtRemover = function (t) { return t = (t = (t = (t = (t = t.replace(/<jsredt-removable>\s*<\/jsredt-removable>/gis, "")).replace(/<!--\s*jsredt-init:before\s*-->.*<\/jsredt-editable>/gis, "</jsredt-editable>")).replace(/<!--\s*jsredt-init:begin\s*-->.*<!--\s*jsredt-init:end\s*-->/gis, "")).replace(/<!--\s*jsredt-container:begin\s*-->.*<!--\s*jsredt-container:end\s*-->/gis, "")).replace(/<\/?jsredt-editable[^>]*>/gis, "") }, jsrHtmlEditor.prototype.removable = function () { var t = this, e = 0; this.removableHtml = [], document.querySelectorAll("jsredt-removable").forEach((function (i) { t.removableHtml[e++] = i.innerHTML, i.innerHTML = "" })) }, jsrHtmlEditor.prototype.undoRemovable = function () { var t = this, e = 0; document.querySelectorAll("jsredt-removable").forEach((function (i) { i.innerHTML = t.removableHtml[e++] })) }, jsrHtmlEditor.prototype.editToggle = function () { this.editEnable ? this.editOff() : this.editOn() }, jsrHtmlEditor.prototype.undo = function () { this.undoredo(!0) }, jsrHtmlEditor.prototype.redo = function () { this.undoredo(!1) }, jsrHtmlEditor.prototype.up = function () { this.focused.parentElement && (this.setFocus(this.focused.parentElement), this.focused.scrollIntoView({ block: "center" })) }, jsrHtmlEditor.prototype.down = function () { this.focused.firstElementChild && (this.setFocus(this.focused.firstElementChild), this.focused.scrollIntoView({ block: "center" })) }, jsrHtmlEditor.prototype.copy = function () { this.focused != this.editable && (this.clipboard = this.focused.outerHTML, document.dispatchEvent(new Event("editorchanges"))) }, jsrHtmlEditor.prototype.cut = function () { this.focused != this.editable && (this.clipboard = this.focused.outerHTML, this.focused.parentElement.removeChild(this.focused), this.setFocus(this.focused.parentElement)) }, jsrHtmlEditor.prototype.paste = function () { this.clipboard && this.focused != this.editable && this.focused.insertAdjacentHTML("afterend", this.clipboard) }, jsrHtmlEditor.prototype.disabledEdit = function () { return !1 }, jsrHtmlEditor.prototype.disabledSave = function () { return !(this.editEnable && !this.saving) }, jsrHtmlEditor.prototype.disabledUno = function () { return !this.editEnable || !this.historyUndo.length }, jsrHtmlEditor.prototype.disabledRedo = function () { return !this.editEnable || !this.historyRedo.length }, jsrHtmlEditor.prototype.disabledUp = function () { return !(this.editEnable && this.focused.parentElement && this.focused.parentElement.isContentEditable) }, jsrHtmlEditor.prototype.disabledDown = function () { return !this.editEnable || !this.focused.firstElementChild }, jsrHtmlEditor.prototype.disabledCut = function () { return !this.editEnable || this.focused == this.editable }, jsrHtmlEditor.prototype.disabledCopy = function () { return !this.editEnable || this.focused == this.editable }, jsrHtmlEditor.prototype.disabledPaste = function () { return !this.editEnable || !this.clipboard || this.focused == this.editable }, jsrHtmlEditor.prototype.disabledLink = function () { return !this.editEnable }, jsrHtmlEditor.prototype.disabledImage = function () { return !this.editEnable }, jsrHtmlEditor.prototype.disabledHead = function () { return !this.editEnable }, jsrHtmlEditor.prototype.disabledCode = function () { return !this.editEnable }, jsrHtmlEditor.prototype.setObserver = function () { return new MutationObserver((function (t) { _this.editEnable && !_this.ignoreMutations && (t.forEach((function (t) { switch (t.time = Date.now() / 1e4, t.type) { case "characterData": t.newValue = t.target.nodeValue, _this.historyUndo.push(t), _this.resetLinearHistory(), document.dispatchEvent(new Event("contentchanges")); break; case "attributes": var e = t.attributeName, i = t.target.getAttribute(t.attributeName); (_this.focused.contains(t.target) || document.head.contains(t.target)) && _this.historyForceCheck(e, i) && (t.newValue = i, _this.historyUndo.push(t), _this.historyForceRemove(e, i), _this.resetLinearHistory(), document.dispatchEvent(new Event("contentchanges"))); break; case "childList": _this.historyUndo.push(t), _this.resetLinearHistory(), document.dispatchEvent(new Event("contentchanges")) } })), document.dispatchEvent(new Event("editorchanges"))) })) }, jsrHtmlEditor.prototype.observe = function () { this.observer.observe(this.editable, { attributes: !0, characterData: !0, childList: !0, subtree: !0, attributeOldValue: !0, characterDataOldValue: !0 }), this.options.toolbar.includes("head") && this.observer.observe(document.head, { attributes: !0, characterData: !0, childList: !0, subtree: !0, attributeOldValue: !0, characterDataOldValue: !0 }) }, jsrHtmlEditor.prototype.resetLinearHistory = function () { this.historyRedo.length && this.options.linearHistory && (this.historyRedo = []) }, jsrHtmlEditor.prototype.historyForcePush = function (t, e) { var i = t + ":" + e.toString(); this.historyForce.push(i) }, jsrHtmlEditor.prototype.historyForceCheck = function (t, e) { var i = t + ":" + (e || "").toString(); return this.historyForce.includes(i) }, jsrHtmlEditor.prototype.historyForceRemove = function (t, e) { var i = t + ":" + e.toString(); this.historyForce.includes(i) && this.historyForce.splice(this.historyForce.indexOf(i), 1) }, jsrHtmlEditor.prototype.undoredo = function (t) { this.observer.disconnect(); for (var e = null; ;) { if (t) { if (!this.historyUndo.length) break; var i = this.historyUndo.pop(); if (this.historyRedo.push(i), e && i.time + _this.options.groupingHistory < e) { this.historyUndo.push(i), this.historyRedo.pop(); break } } else { if (!this.historyRedo.length) break; if (i = this.historyRedo.pop(), this.historyUndo.push(i), e && i.time - _this.options.groupingHistory > e) { this.historyRedo.push(i), this.historyUndo.pop(); break } } switch (i.type) { case "characterData": (i.target.parentElement.parentElement.parentElement || i.target.parentElement.parentElement || i.target.parentElement).scrollIntoView({ block: "center" }), this.setFocus(i.target.parentElement), i.target.textContent = t ? i.oldValue : i.newValue; break; case "attributes": i.target.scrollIntoView({ block: "center" }), this.setFocus(i.target); var o = t ? i.oldValue : i.newValue; null === o ? i.target.removeAttribute(i.attributeName) : i.target.setAttribute(i.attributeName, o); break; case "childList": i.target.scrollIntoView({ block: "center" }), this.setFocus(i.target); var s = t ? i.removedNodes : i.addedNodes, r = t ? i.addedNodes : i.removedNodes; Array.from(s).forEach(i.nextSibling ? t => { i.nextSibling.parentNode.insertBefore(t, i.nextSibling) } : t => { i.target.appendChild(t) }), Array.from(r).forEach((function (t) { t.parentNode.removeChild(t) })) }e = i.time } this.observe(), document.dispatchEvent(new Event("editorchanges")), document.dispatchEvent(new Event("contentchanges")) }, jsrHtmlEditor.prototype.setEventEditorChanges = function () { var t = this; document.addEventListener("editorchanges", (function () { t.setDisabledBtns() })) }, jsrHtmlEditor.prototype.setEvents = function () { var t = this; this.editable.addEventListener("click", (function (e) { t.focused != e.target && t.setFocus(e.target) }), !0), this.editable.addEventListener("input", (function (e) { "insertParagraph" == e.inputType && setTimeout((function () { t.setFocus(document.getSelection().anchorNode) }), 50) }), !0), this.editable.addEventListener("dblclick", (function () { "A" == t.focused.tagName || "A" == t.focused.parentElement.tagName ? t.command(t.options.buttons.link) : "IMG" == t.focused.tagName || "IMG" == t.focused.parentElement.tagName ? t.command(t.options.buttons.image) : t.command(t.options.buttons.code) }), !0), document.addEventListener("contentchanges", (function () { window.onbeforeunload = function (t) { return t.returnValue = "", "" } })) }, jsrHtmlEditor.prototype.setEventsToolbar = function () { for (var t of (_this = this, this.options.toolbar)) { var e = this.options.buttons[t], i = document.querySelectorAll(".jsredt-toolbar-btn-" + e.name); for (btn of i) btn.addEventListener("click", o(e)) } function o(t) { return function (e) { _this.command(t) } } }, jsrHtmlEditor.prototype.command = function (t) { t.action() }, jsrHtmlEditor.prototype.setDisabledBtns = function () { for (var t of this.options.toolbar) { var e = this.options.buttons[t], i = document.querySelectorAll(".jsredt-toolbar-btn-" + e.name); for (button of i) button.disabled = e.disabled() } }, jsrHtmlEditor.prototype.movable = function (t, e) { new jsrMoveable(t, e) }, jsrHtmlEditor.prototype.renderTollbar = function () { var t = document.createElement("toolbar"); for (var e of (t.id = "jsredt-toolbar", t.classList.add("jsredt-toolbar"), t.innerHTML = '<button class="jsredt-toolbar-dragger jsredt-toolbar-btn" id="jsredt-toolbar-dragger">   <img class="jsredt-toolbar-icon-dragger jsredt-toolbar-icon" src="' + this.options.draggerIcon + '" title="Move"></button>', this.options.toolbar)) { var i = this.options.buttons[e], o = document.createElement("button"); o.classList.add("jsredt-toolbar-btn"), o.classList.add("jsredt-toolbar-btn-" + i.name), o.disabled = i.disabled(), o.innerHTML = '<img class="jsredt-toolbar-icon" src="' + i.icon + '" title="' + i.title + '">', t.append(o) } if (this.container.append(t), this.options.toolbarCols) { var s = window.getComputedStyle(t), r = parseInt(s.getPropertyValue("padding")), d = parseInt(s.getPropertyValue("border")); t.style.width = 42 * this.options.toolbarCols + 2 * r + 2 * d + "px" } return t }, jsrHtmlEditor.prototype.renderDialogCode = function () { var t = '<dialog id="jsredt-dialog-code" class="jsredt-dialog">    <div class="jsredt-btns">       <div class="jsredt-btns-left">           <button type="button" class="sbutton dragger"><img class="" src="' + this.options.draggerIcon + '" title="Move"> <span>Edit source code</span></button>       </div>       <div class="jsredt-btns-right">           <button type="button" class="sbutton cancel"> <b>&Cross;</b> </button>       </div>   </div>   <div class="body">       <textarea class="code sbutton" placeholder=" ( empty ) "></textarea>   </div>   <div class="jsredt-btns">       <div class="jsredt-btns-left">           <button type="button" class="sbutton parent">&Uparrow;</button>           <button type="button" class="sbutton child">&Downarrow;</button>           <button type="button" class="sbutton link"><img class="" src="' + this.options.buttons.link.icon + '" title="Edit link"></button>           <button type="button" class="sbutton image"><img class="" src="' + this.options.buttons.image.icon + '" title="Edit image"></button>       </div>       <div class="jsredt-btns-right">           <button type="button" class="sbutton confirm">&check; Ok</button>       </div>   </div></dialog>'; return this.container.insertAdjacentHTML("beforeend", t), document.getElementById("jsredt-dialog-code") }, jsrHtmlEditor.prototype.setEventsDialogCode = function () { var t = this; document.querySelector("#jsredt-dialog-code .cancel").addEventListener("click", (function () { t.dialogCode.close() })), document.querySelector("#jsredt-dialog-code .parent").addEventListener("click", (function () { t.editCodeParent() })), document.querySelector("#jsredt-dialog-code .child").addEventListener("click", (function () { t.editCodeChild() })), document.querySelector("#jsredt-dialog-code .confirm").addEventListener("click", (function () { t.editCodeConfirm() })), document.querySelector("#jsredt-dialog-code .link").addEventListener("click", (function () { t.dialogCode.open && t.dialogCode.close(), t.command(t.options.buttons.link) })), document.querySelector("#jsredt-dialog-code .image").addEventListener("click", (function () { t.dialogCode.open && t.dialogCode.close(), t.setFocus(t.focused.querySelector("img")), t.command(t.options.buttons.image) })) }, jsrHtmlEditor.prototype.editCode = function () { this.editEnable && (this.focused.querySelector("img") || this.focused.parentElement.querySelector("img") ? this.dialogCode.querySelector("#jsredt-dialog-code .image").style.visibility = "visible" : this.dialogCode.querySelector("#jsredt-dialog-code .image").style.visibility = "hidden", window.getSelection().toString() || this.focused.querySelector("a") || this.focused.parentElement.querySelector("a") ? this.dialogCode.querySelector("#jsredt-dialog-code .link").style.visibility = "visible" : this.dialogCode.querySelector("#jsredt-dialog-code .link").style.visibility = "hidden", this.dialogCode.querySelector("textarea.code").value = this.focused.innerHTML, this.dialogCode.open || this.dialogCode.showModal()) }, jsrHtmlEditor.prototype.editCodeConfirm = function () { this.editEnable && (this.dialogCode.open && this.dialogCode.close(), this.focused.isContentEditable && this.focused.innerHTML != this.dialogCode.querySelector("textarea.code").value && (this.focused.innerHTML = this.dialogCode.querySelector("textarea.code").value)) }, jsrHtmlEditor.prototype.editCodeParent = function () { this.editEnable && this.focused.parentElement && this.focused.parentElement.isContentEditable && (this.setFocus(this.focused.parentElement), this.editCode()) }, jsrHtmlEditor.prototype.editCodePrev = function () { this.editEnable && this.focusedPrev && this.focusedPrev.isContentEditable && (this.setFocus(this.focusedPrev), this.editCode()) }, jsrHtmlEditor.prototype.editCodeChild = function () { this.editEnable && this.focused.firstElementChild && this.focused.firstElementChild.isContentEditable && (this.setFocus(this.focused.firstElementChild), this.editCode()) }, jsrHtmlEditor.prototype.renderDialogImage = function () { var t = '<dialog id="jsredt-dialog-image" class="jsredt-dialog">    <div class="jsredt-btns">       <div class="jsredt-btns-left">           <button type="button" class="sbutton dragger"><img class="" src="' + this.options.draggerIcon + '" title="Move"> <span id="jsredt-dialog-image-title">Edit image</span></button>       </div>       <div class="jsredt-btns-right">           <button type="button" class="sbutton cancel"> <b>&Cross;</b> </button>       </div>   </div>   <div class="body">       <div class="preview">           <img class="image" src="' + this.options.buttons.image.icon + '">           <button id="jsredt-dialog-image-upload" type="button" class="upload sbutton">&UpArrowBar; Upload</button>           <input id="jsredt-dialog-image-file" class="file" accept="image/*" type="file" />       </div>       <label for="jsredt-dialog-image-src">Image URL:</label>       <input id="jsredt-dialog-image-src" class="src sbutton" type="text">       <div class="separator"></div>       <label for="jsredt-dialog-image-alt">Alt. text:</label>       <input id="jsredt-dialog-image-alt" class="alt sbutton" type="text">       <div class="separator"></div>       <input size="3" id="jsredt-dialog-image-width" class="width sbutton" type="text" placeholder="auto">       <button type="button" class="sbutton style-width" value="100%">&longleftrightarrow;</button>       <button type="button" class="sbutton style-width" value="50%">50%</button>       <button type="button" class="sbutton style-width" value="25%">25%</button>       <button type="button" class="sbutton style-width" value="">&circlearrowleft;</button>       <div class="separator"></div>       <input size="3" id="jsredt-dialog-image-height" class="height sbutton style-height" type="text" placeholder="auto">       <button type="button" class="sbutton style-height" value="100%">&UpDownArrow;</button>       <button type="button" class="sbutton style-height" value="">&circlearrowleft;</button>       <div class="separator"></div>       <input size="3" id="jsredt-dialog-image-float" class="float sbutton style-float" type="text" placeholder="no">       <button type="button" class="sbutton style-float" value="left">&looparrowleft;</button>       <button type="button" class="sbutton style-float" value="right">&looparrowright;</button>       <button type="button" class="sbutton style-float" value="">&circlearrowleft;</button>       <div class="separator"></div>       <input size="3" id="jsredt-dialog-image-padding" class="padding sbutton style-padding" type="text" placeholder="no">       <button type="button" class="sbutton style-padding" value="10px">&sdotb;</button>       <button type="button" class="sbutton style-padding" value="">&circlearrowleft;</button>       <div class="image-remove">           <div class="separator"></div>           <label for="jsredt-dialog-image-remove">Remove image:</label>           <input id="jsredt-dialog-image-remove" class="remove" type="checkbox">       </div>   </div>   <div class="jsredt-btns">       <div class="jsredt-btns-left">           <button type="button" class="sbutton parent">&Uparrow;</button>           <button type="button" class="sbutton child">&Downarrow;</button>           <button type="button" class="sbutton code"><img class="" src="' + this.options.buttons.code.icon + '" title="Edit code"></button>           <button type="button" class="sbutton link"><img class="" src="' + this.options.buttons.link.icon + '" title="Edit link"></button>       </div>       <div class="jsredt-btns-right">           <button type="button" class="sbutton confirm">&check; Ok</button>       </div>   </div></dialog>'; return this.container.insertAdjacentHTML("beforeend", t), document.getElementById("jsredt-dialog-image") }, jsrHtmlEditor.prototype.setEventsDialogImage = function () { var t = this; document.querySelector("#jsredt-dialog-image .cancel").addEventListener("click", (function () { t.dialogImage.close() })), document.querySelector("#jsredt-dialog-image .confirm").addEventListener("click", (function () { t.editImageConfirm() })), document.querySelector("#jsredt-dialog-image .parent").addEventListener("click", (function () { t.editImageParent() })), document.querySelector("#jsredt-dialog-image .child").addEventListener("click", (function () { t.editImageChild() })), document.querySelector("#jsredt-dialog-image .code").addEventListener("click", (function () { t.dialogImage.open && t.dialogImage.close(), t.command(t.options.buttons.code) })), document.querySelector("#jsredt-dialog-image .link").addEventListener("click", (function () { t.dialogImage.open && t.dialogImage.close(), t.command(t.options.buttons.link) })), document.querySelector("#jsredt-dialog-image .upload").addEventListener("click", (function () { document.querySelector("#jsredt-dialog-image-file").dispatchEvent(new MouseEvent("click")) })), document.querySelector("#jsredt-dialog-image-file").addEventListener("change", (function (e) { if (this.files[0].size > t.options.maxImageUpload) { var i = (t.options.maxImageUpload / 1024 / 1024).toFixed(1); return alert("File is too big! " + i + "Mb. max. (Use .webp format)"), this.value = "", !1 } var o = new window.FileReader; o.readAsDataURL(this.files[0]), o.onloadend = function () { t.dialogImage.querySelector("#jsredt-dialog-image .image").src = o.result, t.dialogImage.querySelector("#jsredt-dialog-image .src").value = "data:image/..." } })), document.querySelectorAll("#jsredt-dialog-image button.style-width").forEach((function (e) { e.addEventListener("click", (function (e) { t.dialogImage.querySelector("#jsredt-dialog-image-width").value = e.target.value })) })), document.querySelectorAll("#jsredt-dialog-image button.style-height").forEach((function (e) { e.addEventListener("click", (function (e) { t.dialogImage.querySelector("#jsredt-dialog-image-height").value = e.target.value })) })), document.querySelectorAll("#jsredt-dialog-image button.style-float").forEach((function (e) { e.addEventListener("click", (function (e) { t.dialogImage.querySelector("#jsredt-dialog-image-float").value = e.target.value, e.target.value ? t.dialogImage.querySelector("#jsredt-dialog-image-padding").value = "10px" : t.dialogImage.querySelector("#jsredt-dialog-image-padding").value = "" })) })), document.querySelectorAll("#jsredt-dialog-image button.style-padding").forEach((function (e) { e.addEventListener("click", (function (e) { t.dialogImage.querySelector("#jsredt-dialog-image-padding").value = e.target.value })) })) }, jsrHtmlEditor.prototype.editImage = function () { this.editEnable && ("IMG" == this.focused.parentElement.tagName && this.editImageParent(), this.focused.firstElementChild && this.focused.lastElementChild && "IMG" == this.focused.firstElementChild.tagName && "IMG" == this.focused.lastElementChild.tagName && this.editImageChild(), this.currentSelection = window.getSelection(), this.currentRange = this.currentSelection.getRangeAt(0), this.dialogImage.querySelector("#jsredt-dialog-image-remove").checked = !1, "IMG" == this.focused.tagName ? (window.getComputedStyle(this.focused), this.dialogImage.querySelector("#jsredt-dialog-image-title").innerHTML = "Image (Edit)", this.dialogImage.querySelector(".preview img").src = this.focused.src, this.focused.getAttribute("src").startsWith("data:image/") ? this.dialogImage.querySelector("#jsredt-dialog-image-src").value = "data:image/..." : this.dialogImage.querySelector("#jsredt-dialog-image-src").value = this.focused.getAttribute("src"), this.dialogImage.querySelector("#jsredt-dialog-image-alt").value = this.focused.getAttribute("alt"), this.dialogImage.querySelector("#jsredt-dialog-image-width").value = this.focused.style.width, this.dialogImage.querySelector("#jsredt-dialog-image-height").value = this.focused.style.height, this.dialogImage.querySelector("#jsredt-dialog-image-float").value = this.focused.style.float, this.dialogImage.querySelector("#jsredt-dialog-image-padding").value = this.focused.style.padding, this.dialogImage.querySelector("#jsredt-dialog-image .image-remove").style.visibility = "visible") : (this.dialogImage.querySelector("#jsredt-dialog-image-title").innerHTML = "Image (CREATE)", this.dialogImage.querySelector(".preview img").src = this.options.buttons.image.icon, this.dialogImage.querySelector("#jsredt-dialog-image-src").value = "", this.dialogImage.querySelector("#jsredt-dialog-image-alt").value = "", this.dialogImage.querySelector("#jsredt-dialog-image-width").value = "", this.dialogImage.querySelector("#jsredt-dialog-image-height").value = "", this.dialogImage.querySelector("#jsredt-dialog-image-float").value = "", this.dialogImage.querySelector("#jsredt-dialog-image-padding").value = "", this.dialogImage.querySelector("#jsredt-dialog-image .image-remove").style.visibility = "hidden"), this.dialogImage.open || this.dialogImage.showModal()) }, jsrHtmlEditor.prototype.editImageConfirm = function () { this.dialogImage.open && this.dialogImage.close(), this.editEnable && this.focused.isContentEditable && ("IMG" == this.focused.tagName ? this.dialogImage.querySelector("#jsredt-dialog-image-remove").checked ? this.focused.outerHTML = this.focused.innerHTML : this.editImageConfirmExisting() : this.editImageConfirmNew()) }, jsrHtmlEditor.prototype.editImageConfirmExisting = function () { var t = this.dialogImage.querySelector("#jsredt-dialog-image-src").value, e = this.dialogImage.querySelector("#jsredt-dialog-image-alt").value, i = this.dialogImage.querySelector("#jsredt-dialog-image-width").value, o = this.dialogImage.querySelector("#jsredt-dialog-image-height").value, s = this.dialogImage.querySelector("#jsredt-dialog-image-float").value, r = this.dialogImage.querySelector("#jsredt-dialog-image-padding").value, d = this.focused.getAttribute("src"), n = this.focused.getAttribute("alt"), a = this.focused.style.width, l = this.focused.style.height, A = this.focused.style.float, c = this.focused.style.padding; i && !isNaN(i) && (i += "%"), o && !isNaN(o) && (o += "%"), r && !isNaN(r) && (r += "px"), d != t && ("data:image/..." == t && (t = this.dialogImage.querySelector("#jsredt-dialog-image .image").src), this.historyForcePush("src", t), this.focused.setAttribute("src", t)), n != e && (this.historyForcePush("alt", e), this.focused.setAttribute("alt", e)), a != i && (this.focused.style.width = i, this.historyForcePush("style", this.focused.style.cssText)), l != o && (this.focused.style.height = o, this.historyForcePush("style", this.focused.style.cssText)), A != s && (this.focused.style.float = s, this.historyForcePush("style", this.focused.style.cssText)), c != r && (this.focused.style.padding = r, this.historyForcePush("style", this.focused.style.cssText)) }, jsrHtmlEditor.prototype.editImageConfirmNew = function () { var t = this.dialogImage.querySelector("#jsredt-dialog-image-src").value, e = this.dialogImage.querySelector("#jsredt-dialog-image-alt").value, i = this.dialogImage.querySelector("#jsredt-dialog-image-width").value, o = this.dialogImage.querySelector("#jsredt-dialog-image-height").value, s = this.dialogImage.querySelector("#jsredt-dialog-image-float").value, r = this.dialogImage.querySelector("#jsredt-dialog-image-padding").value; if (isNaN(i) || (i += "%"), isNaN(o) || (o += "%"), t) { "data:image/..." == t && (t = this.dialogImage.querySelector("#jsredt-dialog-image .image").src); var d = document.createElement("img"); d.setAttribute("src", t), d.setAttribute("alt", e), d.style.width = i, d.style.height = o, d.style.float = s, d.style.padding = r, this.currentRange.surroundContents(d) } }, jsrHtmlEditor.prototype.editImageParent = function () { this.editEnable && (this.focused.parentElement && "IMG" == this.focused.parentElement.tagName && this.focused.parentElement.isContentEditable ? (this.setFocus(this.focused.parentElement), this.editImage()) : this.focused.parentElement.parentElement && this.focused.parentElement.parentElement.querySelector("img") && this.focused.parentElement.parentElement.isContentEditable ? (this.setFocus(this.focused.parentElement.parentElement.querySelector("img")), this.editImage()) : this.focused.previousElementSibling && "IMG" == this.focused.previousElementSibling.tagName && this.focused.previousElementSibling.isContentEditable && (this.setFocus(this.focused.previousElementSibling), this.editImage())) }, jsrHtmlEditor.prototype.editImagePrev = function () { this.editEnable && this.focusedPrev && this.focusedPrev.isContentEditable && (this.setFocus(this.focusedPrev), this.editImage()) }, jsrHtmlEditor.prototype.editImageChild = function () { this.editEnable && (this.focused.querySelector("img") ? (this.setFocus(this.focused.querySelector("img")), this.editImage()) : this.focused.nextElementSibling && "IMG" == this.focused.nextElementSibling.tagName && this.focused.nextElementSibling.isContentEditable && (this.setFocus(this.focused.nextElementSibling), this.editImage())) }, jsrHtmlEditor.prototype.renderDialogLink = function () { var t = '<dialog id="jsredt-dialog-link" class="jsredt-dialog">    <div class="jsredt-btns">       <div class="jsredt-btns-left">           <button type="button" class="sbutton dragger"><img class="" src="' + this.options.draggerIcon + '" title="Move"> <span id="jsredt-dialog-link-title">Edit link</span></button>       </div>       <div class="jsredt-btns-right">           <button type="button" class="sbutton cancel"> <b>&Cross;</b> </button>       </div>   </div>   <div class="body">       <label for="jsredt-dialog-link-anchor">Anchor:</label>       <textarea id="jsredt-dialog-link-anchor" rows="2" class="anchor sbutton" placeholder=" ( empty ) "></textarea>       <label for="jsredt-dialog-link-href">URL:</label>       <input id="jsredt-dialog-link-href" class="href sbutton" type="text">       <label for="jsredt-dialog-link-target">Open in new:</label>       <input id="jsredt-dialog-link-target" class="target" type="checkbox">       <div class="link-remove" style="float: right">           <label for="jsredt-dialog-link-remove">Remove link:</label>           <input id="jsredt-dialog-link-remove" class="remove" type="checkbox">       </div>   </div>   <div class="jsredt-btns">       <div class="jsredt-btns-left">           <button type="button" class="sbutton parent">&Uparrow;</button>           <button type="button" class="sbutton child">&Downarrow;</button>           <button type="button" class="sbutton code"><img class="" src="' + this.options.buttons.code.icon + '" title="Edit code"></button>           <button type="button" class="sbutton image"><img class="" src="' + this.options.buttons.image.icon + '" title="Edit image"></button>       </div>       <div class="jsredt-btns-right">           <button type="button" class="sbutton confirm">&check; Ok</button>       </div>   </div></dialog>'; return this.container.insertAdjacentHTML("beforeend", t), document.getElementById("jsredt-dialog-link") }, jsrHtmlEditor.prototype.setEventsDialogLink = function () { var t = this; document.querySelector("#jsredt-dialog-link .cancel").addEventListener("click", (function () { t.dialogLink.close() })), document.querySelector("#jsredt-dialog-link .parent").addEventListener("click", (function () { t.editLinkParent() })), document.querySelector("#jsredt-dialog-link .child").addEventListener("click", (function () { t.editLinkChild() })), document.querySelector("#jsredt-dialog-link .confirm").addEventListener("click", (function () { t.editLinkConfirm() })), document.querySelector("#jsredt-dialog-link .code").addEventListener("click", (function () { t.dialogLink.open && t.dialogLink.close(), t.command(t.options.buttons.code) })), document.querySelector("#jsredt-dialog-link .image").addEventListener("click", (function () { t.dialogLink.open && t.dialogLink.close(), t.command(t.options.buttons.image) })) }, jsrHtmlEditor.prototype.editLink = function () { if (this.editEnable) { if (this.currentSelection = window.getSelection(), this.currentRange = this.currentSelection.getRangeAt(0), "A" == this.focused.parentElement.tagName && this.editLinkParent(), this.focused.firstElementChild && this.focused.lastElementChild && ("A" != this.focused.firstElementChild.tagName || "A" != this.focused.lastElementChild.tagName || this.currentSelection.toString() || this.editLinkChild()), "IMG" == this.focused.tagName || this.focused.firstElementChild && "IMG" == this.focused.firstElementChild.tagName ? this.dialogLink.querySelector("#jsredt-dialog-link .image").style.visibility = "visible" : this.dialogLink.querySelector("#jsredt-dialog-link .image").style.visibility = "hidden", "A" == this.focused.tagName) this.dialogLink.querySelector("#jsredt-dialog-link-title").innerHTML = "Link (Edit)", this.dialogLink.querySelector("#jsredt-dialog-link-anchor").value = this.focused.innerHTML, this.dialogLink.querySelector("#jsredt-dialog-link-href").value = this.focused.getAttribute("href"), this.dialogLink.querySelector("#jsredt-dialog-link-remove").checked = !1, this.dialogLink.querySelector("#jsredt-dialog-link .link-remove").style.visibility = "visible", "_blank" == this.focused.getAttribute("target") ? this.dialogLink.querySelector("#jsredt-dialog-link-target").checked = !0 : this.dialogLink.querySelector("#jsredt-dialog-link-target").checked = !1; else { if (this.currentSelection.anchorNode.nodeType == Node.TEXT_NODE && this.currentSelection.toString()) var t = this.currentSelection; else t = this.focused.innerHTML || this.focused.outerHTML; this.dialogLink.querySelector("#jsredt-dialog-link-title").innerHTML = "Link (CREATE)", this.dialogLink.querySelector(".anchor").value = t, this.dialogLink.querySelector(".href").value = "", this.dialogLink.querySelector("#jsredt-dialog-link-target").checked = !1, this.dialogLink.querySelector("#jsredt-dialog-link-remove").checked = !1, this.dialogLink.querySelector("#jsredt-dialog-link .link-remove").style.visibility = "hidden" } this.dialogLink.open || this.dialogLink.showModal() } }, jsrHtmlEditor.prototype.editLinkConfirm = function () { this.dialogLink.open && this.dialogLink.close(), this.editEnable && this.focused.isContentEditable && ("A" == this.focused.tagName ? this.dialogLink.querySelector("#jsredt-dialog-link-remove").checked ? this.focused.outerHTML = this.focused.innerHTML : this.editLinkConfirmExisting() : this.editLinkConfirmNew()) }, jsrHtmlEditor.prototype.editLinkConfirmExisting = function () { var t = this.dialogLink.querySelector("#jsredt-dialog-link-target").checked ? "_blank" : "", e = this.dialogLink.querySelector("#jsredt-dialog-link-anchor").value, i = this.dialogLink.querySelector("#jsredt-dialog-link-href").value, o = this.focused.getAttribute("target"), s = this.focused.innerHTML, r = this.focused.getAttribute("href"); o == t && s == e && r == i || (this.historyForcePush("href", i), this.historyForcePush("target", t), this.focused.innerHTML = e, this.focused.setAttribute("href", i), this.focused.setAttribute("target", t)) }, jsrHtmlEditor.prototype.editLinkConfirmNew = function () { var t = this.dialogLink.querySelector("#jsredt-dialog-link-target").checked ? "_blank" : "", e = this.dialogLink.querySelector("#jsredt-dialog-link-anchor").value, i = this.dialogLink.querySelector("#jsredt-dialog-link-href").value; if (e.length || i.length) { var o = document.createElement("a"); o.setAttribute("href", i), o.setAttribute("target", t), this.focused.contains(this.currentRange.commonAncestorContainer) ? (this.currentRange.surroundContents(o), o.innerHTML = e) : (o.innerHTML = e, this.focused.outerHTML = o.outerHTML) } }, jsrHtmlEditor.prototype.editLinkParent = function () { this.editEnable && this.focused.parentElement && this.focused.parentElement.isContentEditable && (this.setFocus(this.focused.parentElement), this.editLink()) }, jsrHtmlEditor.prototype.editLinkPrev = function () { this.editEnable && this.focusedPrev && this.focusedPrev.isContentEditable && (this.setFocus(this.focusedPrev), this.editLink()) }, jsrHtmlEditor.prototype.editLinkChild = function () { this.editEnable && this.focused.firstElementChild && this.focused.firstElementChild.isContentEditable && (this.setFocus(this.focused.firstElementChild), this.editLink()) }, jsrHtmlEditor.prototype.renderDialogHead = function () { var t = '<dialog id="jsredt-dialog-head" class="jsredt-dialog">    <div class="jsredt-btns">       <div class="jsredt-btns-left">           <button type="button" class="sbutton dragger"><img class="" src="' + this.options.draggerIcon + '" title="Move"> <span id="jsredt-dialog-title">Edit head</span></button>       </div>       <div class="jsredt-btns-right">           <button type="button" class="sbutton cancel"> <b>&Cross;</b> </button>       </div>   </div>   <div class="body">       <label for="jsredt-dialog-head-title">Title:</label>       <input id="jsredt-dialog-head-title" class="title sbutton" type="text">       <div class="separator"></div>       <label for="jsredt-dialog-head-description">Description:</label>       <textarea id="jsredt-dialog-head-description" rows="3" class="description sbutton" placeholder=" ( empty ) "></textarea>       <div class="separator"></div>       <div class="edit-all" style="display: none">           <label for="jsredt-dialog-head-all">Edit source code:</label>           <textarea id="jsredt-dialog-head-all" rows="3" class="all sbutton" placeholder=" ( empty ) "></textarea>       </div>   </div>   <div class="jsredt-btns">       <div class="jsredt-btns-left">           <button type="button" class="sbutton show-all"><img class="" src="' + this.options.buttons.code.icon + '" title="Edit code"> Edit all</button>       </div>       <div class="jsredt-btns-right">           <button type="button" class="sbutton confirm">&check; Ok</button>       </div>   </div></dialog>'; return this.container.insertAdjacentHTML("beforeend", t), document.getElementById("jsredt-dialog-head") }, jsrHtmlEditor.prototype.setEventsDialogHead = function () { var t = this; document.querySelector("#jsredt-dialog-head .cancel").addEventListener("click", (function () { t.dialogHead.close() })), document.querySelector("#jsredt-dialog-head .show-all").addEventListener("click", (function () { "none" == t.dialogHead.querySelector("#jsredt-dialog-head .edit-all").style.display ? t.dialogHead.querySelector("#jsredt-dialog-head .edit-all").style.display = "inline-block" : t.dialogHead.querySelector("#jsredt-dialog-head .edit-all").style.display = "none" })), document.querySelector("#jsredt-dialog-head .confirm").addEventListener("click", (function () { t.editHeadConfirm() })) }, jsrHtmlEditor.prototype.editHead = function () { if (this.editEnable) { if (document.head.querySelector('meta[name="description"]')) var t = document.head.querySelector('meta[name="description"]').getAttribute("content"); else t = ""; this.dialogHead.querySelector("#jsredt-dialog-head-title").value = document.title || "pedo", this.dialogHead.querySelector("#jsredt-dialog-head-description").value = t, this.dialogHead.querySelector("#jsredt-dialog-head-all").value = document.head.innerHTML, this.dialogHead.open || this.dialogHead.showModal() } }, jsrHtmlEditor.prototype.editHeadConfirm = function () { if (this.dialogHead.open && this.dialogHead.close(), this.editEnable) { if (document.head.querySelector('meta[name="description"]')) var t = document.head.querySelector('meta[name="description"]').getAttribute("content"); else t = ""; var e = this.dialogHead.querySelector("#jsredt-dialog-head-title").value, i = this.dialogHead.querySelector("#jsredt-dialog-head-description").value, o = this.dialogHead.querySelector("#jsredt-dialog-head-all").value, s = document.title, r = t; if (o != document.head.innerHTML && (document.head.innerHTML = o), e != s && (document.title = e), i != r) { if (!document.head.querySelector('meta[name="description"]')) { var d = document.createElement("meta"); d.setAttribute("name", "description"), document.head.appendChild(d) } this.historyForcePush("content", i), document.head.querySelector('meta[name="description"]').setAttribute("content", i) } } }, window.jsrMoveable = function (t, e) { this.movable = document.querySelector(t), this.dragger = document.querySelector(e), "ontouchstart" in document.createElement("div") ? this.movableOnTouch() : this.movableOnDrag() }, jsrMoveable.prototype.movableOnDrag = function () { var t = this, e = 0, i = 0, o = 0, s = 0; function r(r) { (r = r || window.event).preventDefault(), e = o - r.clientX, i = s - r.clientY, o = r.clientX, s = r.clientY, t.movable.style.top = t.movable.offsetTop - i + "px", t.movable.style.left = t.movable.offsetLeft - e + "px" } function d() { document.onmouseup = null, document.onmousemove = null; var e = t.dragger.offsetLeft, i = t.movable.offsetLeft + e, o = t.dragger.offsetTop, s = t.movable.offsetTop + o, r = window.innerWidth - t.dragger.offsetWidth, d = window.innerHeight - t.dragger.offsetHeight; s > d && (t.movable.style.top = d - o + "px"), s < 0 && (t.movable.style.top = 0 - o + "px"), i > r && (t.movable.style.left = r - e + "px"), i < 0 && (t.movable.style.left = 0 - e + "px") } this.movable.style.position = "fixed", this.dragger.onmousedown = function (e) { (e = e || window.event).preventDefault(); var i = window.getComputedStyle(t.movable), n = parseInt(i.getPropertyValue("margin-top")), a = parseInt(i.getPropertyValue("margin-left")); t.movable.style.margin = "0px", t.movable.style.top = t.movable.offsetTop + n + "px", t.movable.style.left = t.movable.offsetLeft + a + "px", o = e.clientX, s = e.clientY, document.onmouseup = d, document.onmousemove = r } }, jsrMoveable.prototype.movableOnTouch = function () { var t = this; this.movable.style.position = "fixed", this.dragger.addEventListener("touchmove", (function (e) { e.preventDefault(); var i = t.dragger.offsetLeft + Math.round(t.dragger.offsetWidth / 2), o = t.dragger.offsetTop + Math.round(t.dragger.offsetHeight / 2); t.movable.style.margin = "0px"; var s = e.targetTouches[0]; t.movable.style.left = s.pageX - i + "px", t.movable.style.top = s.pageY - window.pageYOffset - o + "px" })), this.movable.addEventListener("touchend", (function (e) { var i = t.dragger.offsetLeft, o = t.movable.offsetLeft + i, s = t.dragger.offsetTop, r = t.movable.offsetTop + s, d = window.innerWidth - t.dragger.offsetWidth, n = window.innerHeight - t.dragger.offsetHeight; r > n && (t.movable.style.top = n - s + "px"), r < 0 && (t.movable.style.top = 0 - s + "px"), o > d && (t.movable.style.left = d - i + "px"), o < 0 && (t.movable.style.left = 0 - i + "px") })) }, document.currentScript.dataset.jsrheditorauto && window.addEventListener("DOMContentLoaded", (function () { "jsrEditor" in window || (jsrEditor = new jsrHtmlEditor, jsrEditor.start()) })), document.body.innerHTML += '<div id="jsredt-init"></div>', (new jsrHtmlEditor).start();